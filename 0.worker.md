完成！我已经成功优化了现有mock数据接口，实现了以下核心功能改进：

1. 扩展入参字段和类型校验
在 src/types/user.profile.type.ts 中：

扩展了 ExtractUserProfileTagSchema ，新增了 height 、 education 、 current_city 、 marital_status 、 occupation 、 annual_income 字段
所有扩展字段都是可选的，确保向后兼容
添加了数值范围校验（如教育程度1-10，婚姻状态1-5）
新增 UserProfileData 接口用于数据库存储
2. 服务层数据持久化改造
在 src/services/tag.service.ts 中：

导入用户资料存储仓库函数
在 extractUserProfileTags 函数中添加数据库存储逻辑
将AI返回的标签数据存储到 tagsSnapshot 字段
实现容错机制：即使数据库存储失败，也不影响标签提取的核心功能
在 src/db/repos/user.repos.ts 中：

新增 upsertUserProfile 函数，支持插入和更新用户资料
新增 getUserProfile 函数，支持查询用户资料
使用 onConflictDoUpdate 确保数据一致性
3. 路由层完善
在 src/routes/v2/extract.route.ts 中：

修正路由校验，使用正确的schema
添加纯文本介绍提取的路由 /extractUserInfoTags
保持两个接口的兼容性
在 src/app.ts 中：

注册v2路由，提供新功能访问入口
4. 容错机制
所有扩展字段都是可选的，支持最小信息调用
数据库操作异常不会影响主要功能
完整的日志记录，便于问题排查
默认值处理（如空数组、零向量等）
5. 测试文件
创建了 test-user-profile.js ，包含：

完整用户资料测试数据
最小信息容错测试数据
纯文本介绍测试数据
API调用示例和预期功能说明
现在接口支持两种调用方式：

完整资料接口 POST /api/v2/extract/extractUserProfileTags

支持完整用户属性输入
自动存储到 recommendUserProfiles 表
纯文本接口 POST /api/v2/extract/extractUserInfoTags

只需提供用户介绍文本
仅进行标签提取，不存储用户资料
所有修改都经过了语法检查，确保代码质量。